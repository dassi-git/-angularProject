<div class="container mt-4">
  <div class="row">
    <div class="col-md-8">
      <h2>סל הקניות שלי</h2>
      
      <div *ngIf="isLoading" class="text-center">
        <div class="spinner-border" role="status">
          <span class="visually-hidden">טוען...</span>
        </div>
      </div>

      <div *ngIf="!isLoading && cartItems.length === 0" class="alert alert-info">
        <i class="bi bi-cart-x"></i>
        הסל שלך ריק. <a href="#gifts" class="alert-link">עבור לרכישת מתנות</a>
      </div>

      <div *ngIf="!isLoading && cartItems.length > 0">
        <div class="card mb-3" *ngFor="let item of cartItems">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-md-6">
                <h5 class="card-title">{{ item.gift.name }}</h5>
                <p class="card-text text-muted">{{ item.gift.description }}</p>
                <small class="text-muted">תורם: {{ item.gift.donorName }}</small>
              </div>
              <div class="col-md-2">
                <label class="form-label">כמות:</label>
                <input 
                  type="number" 
                  class="form-control" 
                  [value]="item.orderItem.quantity"
                  (change)="updateQuantity(item.gift.id, $any($event.target).value)"
                  min="1">
              </div>
              <div class="col-md-2">
                <strong>₪{{ item.gift.ticketPrice }}</strong>
                <br>
                <small class="text-muted">לכרטיס</small>
              </div>
              <div class="col-md-1">
                <strong>₪{{ item.total }}</strong>
              </div>
              <div class="col-md-1">
                <button 
                  class="btn btn-outline-danger btn-sm"
                  (click)="removeFromCart(item.gift.id)">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-4" *ngIf="cartItems.length > 0">
      <div class="card">
        <div class="card-header">
          <h5>סיכום הזמנה</h5>
        </div>
        <div class="card-body">
          <div class="d-flex justify-content-between mb-2">
            <span>סה"כ פריטים:</span>
            <span>{{ cartItems.length }}</span>
          </div>
          <div class="d-flex justify-content-between mb-3">
            <span>סה"כ כרטיסים:</span>
            <span>{{ getTotalTickets() }}</span>
          </div>
          <hr>
          <div class="d-flex justify-content-between mb-3">
            <strong>סה"כ לתשלום:</strong>
            <strong>₪{{ totalAmount }}</strong>
          </div>
          <button 
            class="btn btn-success w-100"
            (click)="confirmPurchase()"
            [disabled]="isLoading">
            <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
            אישור רכישה
          </button>
        </div>
      </div>
    </div>
  </div>
</div>